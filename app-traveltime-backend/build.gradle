apply plugin: 'java'
apply plugin: 'kotlin'
apply plugin: 'kotlinx-serialization'
apply plugin: 'application'
apply plugin: 'kotlin-kapt'
//apply plugin: 'war'

sourceCompatibility = 1.8

compileKotlin {
    kotlinOptions.jvmTarget = "1.8"
}
compileTestKotlin {
    kotlinOptions.jvmTarget = "1.8"
}

kotlin {
    experimental {
        coroutines "enable"
    }
}

//war {
//    manifest {
//        attributes 'Main-Class': 'org.opensilk.traveltime.Runner'
//    }
//}

mainClassName = 'org.opensilk.traveltime.BackendappKt'

//(getTasksByName("run", false).first() as JavaExec).args('-config=embedded.conf')

dependencies {
    kapt "com.google.dagger:dagger-compiler:$dagger2Version"
    implementation "com.google.dagger:dagger:$dagger2Version"
    implementation "javax.annotation:javax.annotation-api:1.2"

    implementation group: 'javax', name: 'javaee-api', version: '7.0'
    implementation "org.jetbrains.kotlin:kotlin-stdlib-jre8:$kotlin_version"
    implementation "org.jetbrains.kotlin:kotlin-reflect:$kotlin_version"
    implementation "org.jetbrains.kotlinx:kotlinx-serialization-runtime:$serialization_version"
    implementation "io.ktor:ktor-server-jetty:$ktor_version"
    implementation "io.ktor:ktor-locations:$ktor_version"
    implementation "org.mapdb:mapdb:3.0.5"
    implementation "org.hashids:hashids:1.0.3"

    testImplementation "junit:junit:$test_junitVersion"
    testImplementation "org.assertj:assertj-core:$test_assertJVersion"
    testImplementation "org.jetbrains.kotlin:kotlin-test-junit:$kotlin_version"
}
